"use strict";var b=Object.create;var m=Object.defineProperty;var x=Object.getOwnPropertyDescriptor;var N=Object.getOwnPropertyNames;var T=Object.getPrototypeOf,C=Object.prototype.hasOwnProperty;var E=(t,o)=>{for(var n in o)m(t,n,{get:o[n],enumerable:!0})},S=(t,o,n,a)=>{if(o&&typeof o=="object"||typeof o=="function")for(let i of N(o))!C.call(t,i)&&i!==n&&m(t,i,{get:()=>o[i],enumerable:!(a=x(o,i))||a.enumerable});return t};var g=(t,o,n)=>(n=t!=null?b(T(t)):{},S(o||!t||!t.__esModule?m(n,"default",{value:t,enumerable:!0}):n,t)),P=t=>S(m({},"__esModule",{value:!0}),t);var J={};E(J,{createDevToolsNodeSys:()=>O});module.exports=P(J);var s=require("fs/promises"),v=require("crypto"),d=require("fs"),p=require("os"),l=g(require("path"),1),h=g(require("prettier"),1),D=g(require("typescript"),1),F=g(require("launch-editor"),1);async function w(t,o){let n=t.resolve("/");for(let a=0;a<20;a++){let i=t.join(o,"package.json"),u=await t.readFile(i);if(u)return JSON.parse(u);if(o===n)break;o=t.dirname(o)}return null}async function k(t){let o=[],n=await w(t,t.getRootDir());if(n){let a=j(n);o.push(...a)}return o}function j(t){let o=[];if(t&&typeof t=="object"){let n=new Set(Object.keys({...t.dependencies,...t.devDependencies}));for(let a of R)n.has(a)&&(o.some(i=>i.name===a)||o.push({name:a}))}return o}var R=["@shopify/remix-oxygen","@shopify/hydrogen","@builder.io/qwik-city","@remix-run/react","@sveltejs/kit","astro","gatsby","next","nuxt","@builder.io/qwik","angular","react","solid-js","svelte","vue"];async function O(t){let o=new Set,n=(...e)=>{if(process.env.DEBUG){let r=new Date,c=`${String(r.getMinutes()).padStart(2,"0")}:${String(r.getSeconds()).padStart(2,"0")}.${String(r.getMilliseconds()).padStart(3,"0")}`;console.debug(c,"[builder-dev-tools]",...e)}},a=async e=>{let r=(0,v.createHash)("md5");return r.update(e),r.digest("hex")},i={...l.default,getRootDir:()=>l.default.normalize(t.getRootDir()),cwd:()=>process.cwd(),exists:async e=>{try{return await(0,s.access)(e),!0}catch{return!1}},existsSync:e=>(0,d.existsSync)(e),readdir:async(e,r)=>{let c=await(0,s.readdir)(e);return r?c.map(f=>l.default.join(e,f)):c},readdirSync:e=>(0,d.readdirSync)(e),readFile:async e=>{y(t,e);try{return await(0,s.readFile)(e,"utf-8")}catch(r){if(r.code==="ENOENT")return null;throw n(r,e),r}},readFileSync(e){y(t,e);try{return(0,d.readFileSync)(e,"utf-8")}catch(r){if(r.code==="ENOENT")return null;throw n(r,e),r}},stat:async e=>await(0,s.stat)(e),statSync:e=>(0,d.statSync)(e),writeFile:async(e,r)=>{y(t,e),e=l.default.normalize(e);let c={path:e,basename:l.default.basename(e),dirname:l.default.dirname(e),extname:l.default.extname(e)};await(0,s.mkdir)(l.default.dirname(e),{recursive:!0}),await(0,s.writeFile)(e,r);for(let f of o)await f(c)},hash:a,getDeviceId:()=>a(`${(0,p.hostname)()}:${(0,p.homedir)()}`),formatCode:async(e,r)=>{let c=null;try{c=await h.default.resolveConfig(e)}catch{}try{return h.default.format(r,{...c,filepath:e})}catch{}return r},on:(e,r)=>{e==="change"&&o.add(r)},off:(e,r)=>{e==="change"&&o.delete(r)},debug:n,launchEditor:async e=>{try{let r=e.filePath;typeof e.line=="number"&&(r+=`:${e.line}`,typeof e.column=="number"&&(r+=`:${e.column}`)),(0,F.default)(r,"code",(c,f)=>{console.error(`Failed to launch editor for ${c}`),f&&console.error(f)})}catch(r){console.error(`Failed to launch editor for ${String(r.message||r)}`)}},platform:()=>({runtime:"node",os:process.platform}),getFrameworks:()=>[],ts:D.default,version:"1.0.10"},u=await k(i);return i.getFrameworks=()=>u,i}function y(t,o){if(t.skipValidate)return;if(!o)throw new Error(`Invalid path: ${o} (7340)`);o=l.default.normalize(l.default.resolve(o));let n=t.getRootDir();if(!o.startsWith(n))throw new Error(`Invalid path: ${o} (7341)`)}0&&(module.exports={createDevToolsNodeSys});
